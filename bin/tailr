#!/usr/bin/env coffee

nomnom = require 'nomnom'
Tailr = require '../lib/tailr'
path = require 'path'

nomnom.command('list')
  .callback (options) ->
    tailr = new Tailr()
    logNames = (key for own key of tailr.getLogs())
    console.log logNames.join(' ')
  .help("list all available log files from ~/.tailr.json")

nomnom.command('tail')
  .option 'log',
    position: 1,
    help: 'The name of the logfile to tail'
    metavar: 'LOGFILE'
  .callback (options) ->
    tailr = new Tailr()
    tailr.tail(options.log)
  .help("tails a given log file")

nomnom.command('completions')
  .callback ->
    dir = path.resolve(path.join(__dirname, '..', 'completions'))
    console.log "fpath=(#{dir} $fpath)"
    console.log "compinit"
  .help("shows the completion code to add to .zshrc")


nomnom.parse()
